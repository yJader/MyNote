# 第1章 数值分析与科学计算引论

数值分析: 将复杂的计算式转换为指令集中定义过的+、- (×、÷)输入到计算机中, 得到**近似解**

## 1.2  误差的背景介绍

### 1.2.1 来源与分类

| 来源                           | 分类               |
| ------------------------------ | ------------------ |
| 从实际问题中抽象出数学模型     | 模型误差           |
| 通过**测量**得到模型中参数的值 | 观测误差           |
| 求近似解                       | 方法误差(截断误差) |
| 机器字长有限                   | 舍入误差           |

### 1.2.2 误差与有效数字

#### 绝对误差

==绝对误差==: $e^* = x^* - x, 其中x为精确值, x^*为x的近似值$

- 精确值x通常不可求得, 我们只能求出近似值

==绝对误差限==: $|e^*|的上限即为\epsilon^*, 称为\textcolor{#66ccff}{绝对误差限}$ 

- 工程上常记为$x = x^* \pm e^*$, 如$\int_0^1 $

- 注意: 
  e* 理论上讲是唯一确定的，可能取正，也可能取负。
  e* > 0 不唯一，当然 e* 越小越具有参考价值。

#### 相对误差

==相对误差==: <font size=5>$e_r^* = \frac{e^*}x ≈ \frac{e^*}{x^*}$</font>

==相对误差限==: <font size=5>$\epsilon_r^* (= \frac{\epsilon^*}{x}) = \frac{\epsilon^*}{|x^*|} $</font>

#### 有效数字

~~看不懂的~~定义: 用科学记数法, 记$近似值x^*=a_1.a_2a_3...a_n*10^m(其中a_1\neq 0)$, 若$(|e^*|=)\ |x^*-x|\leq \textcolor{red}{0.5}*10^{m-n+1}$(即$a_n$的截取按照四舍五入规则), 则称$x^*$为n位有效数字, 精确到$10^{m-n+1}$

- $m+1$: $x^*$小数点前的位数
  $n$: 有效位数
  $m-n+1$: 

#### 有效数字与相对误差的关系

1. 有效数字→相对误差
   - 已知$x^*$有n位有效数字, 其**相对误差限**为
     $\epsilon_r^*=\frac{\epsilon^*}{|x^*|}=$

#### 数值运算中的误差限



# 第2章 插值法

当精确函数 y = f(x) 非常复杂或未知时，在一系列节点 $x_0 … x_n $处测得函数值$ y_0 = f(x_0), … yn _= f(x_n)$，由此构造一个**简单易算**的近似函数 $P(x) ≈ f(x)$，满足条件$P(x_i) = f(x_i)  (i = 0, … n)$。这里的 P(x) 称为f(x) 的插值函数。

最常用的插值函数是**多项式**

<img src="./计算方法(数值分析).assets/image-20240314084348302.png" alt="image-20240314084348302" style="zoom:50%;" />

### 插值多项式

> 为了使插值函数更方便在计算机上运算,一般插值函数都使用**代数多项式和有理函数**

#### 代数插值多项式的存在唯一性

设函数$y=f(x)$在区间[a,b]上的代数插值多项式为$P(x)=a_0+a_1x+a_2x^2+...+a_nx^n, P_n(x_i)=y_i, i=0, 1,2,...,n$  <font color="orange">书上的命名是$L(x)$ </font>

即多项式$P_n(x)$的系数$a_0, a_1, ...,a_n$满足线性方程组

$\begin{cases}a_0+a_1x_0+a_2x_0^2+...+a_nx_0^n=y_0 \\
a_0+a_1x_1+a_2x_1^2+...+a_nx_1^n=y_1\\......\\
a_0+a_1x_n+a_2x_n^2+...+a_nx_n^n=y_n\end{cases}$ 

上述方程组的系数行列式为n+1阶的Vandermond行列式

$V=\left | \begin{matrix}
1 & x_0 & ...  & x_0^n \\
1 & x_1 & ...  & x_1^n \\
... & ... & ...  & ... \\
1 & x_n & ...  & x_n^n \\
\end{matrix} \right |  =\prod_{i=0}^{n-1}\prod_{j=i+1}^n(x_j-x_i) \neq 0 (x_i\neq x_j)$ 

==定理==: 满足$P(x_i)=y_i, i=0,1,...,n $次数不超过n的**插值多项式一定唯一存在**

- 若多项式次数≠n, 则插值多项式不唯一
  例如$P(x)=L_n(x)+p(x)\prod_{i=0}^n(x-x_i)$也是一个插值多项式，其中p(x)可以是任意多项式。



## 2.2拉格朗日插值

### 2.2.1 线性插值&抛物线插值

复读

插值的目的是求出n次多项式$P(x)=a_0+a_1x+a_2x^2+...+a_nx^n\ 使得\ P_n(x_i)=y_i, i=0,1,...,n$ 

#### 线性插值

即n=1, 已知$y_0=f(x_0), y_1=f(x_1)$ 求$P_1(x)=a_0+a_1x$满足$P_1(x_0)=y_0, P_2(x_1)=y_1$

由几何意义易得

$\begin{aligned}
\boldsymbol{P_{1}}(\boldsymbol{x})& =y_0+\frac{y_1-y_0}{x_1-x_0}(x-x_0)  \\
&={\left[\frac{x-x_1}{x_0-x_1}\right]}y_0+{\left[\frac{x-x_0}{x_1-x_0}\right]}y_1=\sum_{i=0}^{1}\textcolor{red}{l_i(x)}y_i
\end{aligned}$              $\begin{aligned} l_0(x)=\frac{x-x_1}{x_0-x_1}\\l_1(x)=\frac{x-x_0}{x_1-x_0}\end{aligned}$ 



#### 抛物线插值

即n=2, … 略!



### 2.2.2 拉格朗日插值多项式

**==定义—n次插值基函数==**

若n次多项式$l_j(x)(j=0,1,...,n)$在$n+1$个节点$x_0<x_1<...<x_n$上满足条件$l_j(x_k)=\delta_{jk}=\begin{cases}1,&k=j\\0,&k\neq j\end{cases}\quad j,k=0,1,...,n$, 则称这n+1个n次多项式$l_0(x), l_1(x),...,l_n(x)为节点x_0,x_1,...,x_n$上的**n次插值基函数**



与上面的例子类似, 可以推导得出n次插值基函数为$\begin{aligned}
l_k(x)& =\frac{(x-x_0)(x-x_1)\cdots(x-x_{k-1})(x-x_{k+1})\cdots(x-x_n)}{(x_k-x_0)(x_k-x_1)\cdots(x_k-x_{k-1})(x_k-x_{k+1})\cdots(x_k-x_n)}  \\
&=\prod_{i=0}^n\frac{\left(x-x_i\right)}{\left(x_k-x_i\right)}\quad\quad k=0,1,2,\cdots,n \\
\end{aligned}$ 

所以$\color{blue}L_n(x)=\sum_{k=0\\}^ny_kl_k(x)$, 由$l_k(x)$的定义可知$L_n(x_j)=\sum_{k=0\\}^n y_kl_k(x_j)=y_j,j=0,1,...,n$ 满足插值多项式的定义

将形如上述$L_n(x)$的插值多项式称为**拉格朗日(Lagrange)插值多项式**



**简化写法**

记$\omega_{n+1}(x)=(x-x_0)(x-x_1)...(x-x_n)$, 可得$\omega_{n+1}^{\prime}(x_k)=(x_k-x_0)(x_k-x_1)\cdot \cdot\cdot (x_k-x_{k-1})(x_k-x_{k+1})\cdot \cdot \cdot (x_k-x_n)$ 

得$\begin{aligned}
l_k(x)& \begin{aligned}&=\frac{(x-x_0)(x-x_1)\cdots(x-x_{k-1})(x-x_{k+1})\cdots(x-x_n)}{(x_k-x_0)(x_k-x_1)\cdots(x_k-x_{k-1})(x_k-x_{k+1})\cdots(x_k-x_n)}\end{aligned}=\textcolor{blue}{\frac{\omega_{n+1}(x)}{\omega_{n+1}^{\prime}(x_k)(x-x_k)}}\quad\quad\quad k=0,1,2,\cdots,n
\end{aligned}$ 



### 2.2.3 插值余项&误差估计

设区间[a, b]上f(x)的差值多项式为n阶的$L_n(x)$, 令余项$R_n(x) = f(x) - L_n(x)$

显然, 在插值节点$x_i$上有$R_n(x_i) = f(x_i) - L_n(x_i) = 0$ 

因此, $R_n(x)$在[a, b]上有n+1个零点

**设**$R_n(x) = K(x)\omega_{n+1}(x);\quad \omega_{n+1}(x) = (x-x_0)(x-x_1)...(x-x_n)$

此时有$R_n(x) = K(x)\omega_{n+1}(x) = f(x) - L_n(x)$ 



….

得

==拉格朗日型余项定理==: <font size=4>$R_n(x) = K(x)\omega_{n+1}(x) =\frac{f^{(n+1)}(\xi)}{(n+1)!}\omega_{n+1}(x), 其中\omega_{n+1}(x)=\prod_{i=0}^{n}(x-x_i), \xi\in(a,b)$ </font>



## 2.3均差与牛顿插值多项式

### 2.3.1 插值多项式的逐次生成

Lagrange插值多项式的基函数为<font size=4>$l_i(x)=\prod_{j=0\and j\neq i}^{n}\frac{(x-x_j)}{(x_i-x_j)}$</font>

当需要增加节点时, 所有基函数$l_i(x)$都需要重新计算

考虑使用一种逐次生成插值多项式的方法, 记为$P_n(x)$ 

$对0次插值,P_0(x)=f(x_0)$

对1次插值, $\begin{cases}P_1(x_0)=f(x_0)\\P_1(x_1)=f(x_1)\end{cases}$

$$ P_1(x)=f(x_0)+\frac{f(x_1)-f(x_0)}{x_1-x_0}(x_1-x_0)(点斜式)=P_0(x)+a_1(x-x_0)$$ 

对2次插值, $\begin{cases}P_2(x_0)=f(x_0)\\P_2(x_1)=f(x_1)\\P_2(x_1)=f(x_2)\end{cases}$

$P_2(x)=P_1(x)+a_2(x-x_0)(x-x_1)$



…. TODO



可得, $P_n(x)=a_0+a_1(x-x_0)+a_2(x-x_0)(x-x_1)+...+a_n(x-x_0)(x-x_1)...(x-x_n)$

其中$a_0, a_1, ...,a_n可由P_n(x_i)=f(x_i)计算得到$

$P(x_0)=a_0=f(x_0)\\P(x_1)=a_0+a_1(x_1-x_0)=f(x_1)得a_1=\frac{f(x_1)-f(x_0)}{x_1-x_0}\\P$ 

### 2.3.2 均差及其性质

==差商(均差, devided difference)的定义==:

 $一阶差商: f[x_0,x_i]=\frac{f(x_1)-f(x_0)}{x_1-x_0}\\ 
二阶差商: f[x_0, x_1,x_2] =\frac{f[x_1,x_2]-f[x_0,x_1]}{x_2-x_0}\\...\\
k+1阶差商: \begin{aligned}
f[x_0,...,x_{k+1}]& =\frac{f[x_0,x_1,...,x_k]-f[x_1,...,x_k,x_{k+1}]}{x_0-x_{k+1}}  \\
&=\frac{f[x_0,...,x_{k-1},x_k]-f[x_0,...,x_{k-1},x_{k+1}]}{x_k-x_{k+1}}
\end{aligned}$  

是递归定义的

k+1阶差商只需要任选两个k阶差商相减, 并没有固定选择的要求

#### 均差的性质

1. k阶均差





### 2.3.3 牛顿插值多项式

$N_n(x)=\alpha_0+\alpha_1(x-x_0)+\alpha_2(x-x_0)(x-x_1)+....+\alpha_n(x-x_0)...(x-x_{n-1})$

$\left.\left\{\begin{array}{cccc|c}f(x)=f(x_0)+f[x,x_0](x-x_0) & \\ f[x,x_0]=f[x_0,x_1]+f[x,x_0,x_1](x-x_1) \\ ....................\\ f[x,x_0,...,x_{n-1}]=f[x_0,...,x_{n}]+f[x,x_0,...,x_{n}](x-x_{n})\quad& \end{array}\right.\right.$



把后一式带入前一式 $f(x)=\boxed{f(x_0)+f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)+...}$

$(+f[x_0,...,x_n](x-x_0)...(x-x_{n-1})$ $+f[x,x_0,...,x_n](x-x_0)...(x-x_{n-1})(x-x_n)$

$N_n(x)$ $a_i=f[X_0,\ldots,X_i]$ $R_n(x)$



n阶插值多项式$P_n(x)=f[x_0,...,x_n]x^n+?x^{n-1}+...+?x+?1$, **最高项系数**一定为n阶差商

↑可以用来证明性质1, 结合拉格朗日插值公式

## 2.4埃尔米特插值



## 2.5分段低次插值



## 2.6三次样条插值



# 第4章 数值积分

# 第5章 解线性方程组的直接方法

# 第6章 解线性方程组的迭代法

# 第7章 非线性方程与方程组的数值解法