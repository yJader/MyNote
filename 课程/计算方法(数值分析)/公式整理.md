## 第1章 导论

### 误差

**绝对误差**: $e^* = x^* - x, 其中x为精确值, x^*为x的近似值$

**绝对误差限**: $|e^*|的上限\ \varepsilon^*$

**相对误差**: $e_r^* = \frac{e^*}x ≈ \frac{e^*}{x^*}\\$

**相对误差限**: $\varepsilon_r^* (= \frac{\varepsilon^*}{x}) = \frac{\varepsilon^*}{|x^*|}\\$ 

### 有效数字

**有效数字**: 用科学记数法, 记$近似值x^*=a_1.a_2a_3...a_n*10^m(其中a_1\neq 0)$, 若$(|e^*|=)\ |x^*-x|\leq \textcolor{red}{0.5}*10^{m-n+1}$(即$a_n$的截取按照四舍五入规则), 则称$x^*$为n位有效数字, 精确到$10^{m-n+1}$

**有效数字→相对误差限**

- 已知$x^*$有n位有效数字, 其**相对误差限**为
  $\begin{aligned}\varepsilon_r^*&=\left|\frac{\varepsilon^*}{x^*}\right|=\frac{0.5\times10^{-(n-1)}\times10^m}{a_1.a_2\cdots a_n\times10^m}=\frac{10^{-(n-1)}}{2\times a_1.a_2\cdots}\leq\frac1{2a_1}\times10^{-(n-1)}\end{aligned}$ 

**相对误差限→有效数字**

- 已知 x* 的相对误差限可写为$\varepsilon_r*=\frac1{2(a_1+1)}\times10^{-(n-1)}\\$
- 则: $\begin{aligned}\mid x-x^*\mid&\leq\varepsilon_r^*\cdot\mid x^*\mid=\frac{10^{-(n-1)}}{2(a_1+1)}\times a_1.a_2\cdots\times10^m\\&<\frac{10^{-(n-1)}}{2(a_1+1)}\cdot(a_1+1)\times10^m=0.5\times10^{m-n+1}\end{aligned}$

### 误差传递

加法: $y^*=x_1^*+x_2^*$

- $\varepsilon(y^*)\approx\varepsilon(x_1^*)+\varepsilon(x_2^*)$ 误差限直接相加

乘法: $y^*=x_1^*\cdot x_2^*$

- $\varepsilon(y^*)\approx|x_2^*|\varepsilon(x_1^*)+|x_1^*|\varepsilon(x_2^*)$ 
- 会受$|x_1^*|, |x_2^*|$影响

除法: $y^*=\frac{x_1^*}{x_2^*}\\$

- $\varepsilon(y^*)\approx\frac1{\left|x_2^*\right|}\cdot\varepsilon_1^*+\frac{\left|x_1^*\right|}{\left|x_2^*\right|^2}\cdot\varepsilon_2^*\\$

## 第2章 插值法

### 拉格朗日插值

$$
\begin{aligned}
&\textcolor{blue}{L_n(x)}=\sum_{k=0\\}^ny_kl_k(x): Lagrange插值多项式\\
&\textcolor{blue}{l_k(x)}=\frac{\omega_{n+1}(x)}{\omega_{n+1}^{\prime}(x_k)(x-x_k)}: Lagrange插值基函数\\
&\omega_{n+1}(x)=(x-x_0)(x-x_1)...(x-x_n)\\
&\omega_{n+1}^{\prime}(x_k)=(x_k-x_0)(x_k-x_1)\cdot \cdot\cdot (x_k-x_{k-1})(x_k-x_{k+1})\cdot \cdot \cdot (x_k-x_n)
\end{aligned}
$$

**拉格朗日余项**
$$
R_n(x) = K(x)\omega_{n+1}(x) =\frac{f^{(n+1)}(\xi)}{(n+1)!}\omega_{n+1}(x)\quad \xi\in(a,b)
$$


### 牛顿插值

**差商(均差)**
$$
\begin{aligned}
&一阶差商: f[x_0,x_i]=\frac{f(x_1)-f(x_0)}{x_1-x_0}\\ 
&二阶差商: f[x_0, x_1,x_2] =\frac{f[x_1,x_2]-f[x_0,x_1]}{x_2-x_0}\\&...\\
&k+1阶差商: 
f[x_0,...,x_{k+1}]=\frac{f[x_0,x_1,...,x_k]-f[x_1,...,x_k,x_{k+1}]}{x_0-x_{k+1}}  \\
&\qquad\qquad\qquad\qquad\qquad\qquad\ =\frac{f[x_0,...,x_{k-1},x_k]-f[x_0,...,x_{k-1},x_{k+1}]}{x_k-x_{k+1}}
\end{aligned}
$$
**牛顿插值多项式**

基础: $N_n(x)=\alpha_0+\alpha_1(x-x_0)+\alpha_2(x-x_0)(x-x_1)+....+\alpha_n(x-x_0)...(x-x_{n-1})$

代入差商得
$$
\begin{aligned} f(x)=&f(x_0)+f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)+...\\&+f[x_0,...,x_n](x-x_0)...(x-x_{n-1})  &牛顿插值多项式N_n(x)\\
&+f[x,x_0,...,x_n](x-x_0)...(x-x_{n-1})(x-x_n)&牛顿插值多项式余项R_n(x)
\end{aligned}
$$


### Hermite插值

**两点三次Hermite插值**

 $H_3(x)$应满足插值条件

$$
H_3(x_0)=y_0\quad H_3(x_1)=y_1\\
H_3^{\prime}(x_0)=y_0^{\prime}\quad H_3'(x_1)=y_1'
$$
用四个基函数表示$\color{blue}H_3(x) = y_0α_0(x) + y_1\alpha_1(x)+y_0'\beta_0(x)+y'\beta_1(x)$ 
$$
\begin{aligned}\\
\alpha_0(x)&=(1+2l_1(x))\cdot l_0^2(x)~=\left(1+2\frac{x-x_0}{x_1-x_0}\right)\!\left(\frac{x-x_1}{x_0-x_1}\right)^2\\
\alpha_1(x)&=(1+2l_0(x))\cdot l_1^2(x)=\left(1+2\frac{x-x_1}{x_0-x_1}\right)\left(\frac{x-x_0}{x_1-x_0}\right)^2\\\beta_0(x)&=(x-x_0)\cdot l_0^2(x)~=\left(x-x_0\right)\left(\frac{x-x_1}{x_0-x_1}\right)^2\\\beta_1(x)&=(x-x_1)\cdot l_1^2(x)~=\left(x-x_1\right)\left(\frac{x-x_0}{x_1-x_0}\right)^2\end{aligned}
$$
**余项**
$$
R_3(x) = \frac{f^{(4)}(\xi)}{4!}(x-x_0)^2(x-x_1)^2 \quad其中\xi \in[x_0, x_1]
$$

## 第4章 数值积分

 

**简单的积分近似计算方式:** 
$$
梯形公式: T=\frac{b-a}2[f(b)+f(a)]\\
中矩形公式: R=(b-a)f(\frac{b+a}2)\\
机械求积: \textcolor{blue}{\int_a^bf(x)dx\approx \sum_{k=0}^nA_kf(x_k)}, 其中x_k称为求积节点, A_k称为求积系数
$$

- 求积节点一般是给定的, 我们的目标就是确定==求积系数==$A_k$ 



### Newton-Cotes数值求积分

积分区间: $[a,b]$

求积节点: $x_k = a + kh, h = \frac{b-a}{n}$ 

求积系数: $A_k=\int_a^bl_k(x)dx=\cdots=(b-a)C_k^{(n)}\\$

- $C_k^{(n)}$为Cotes系数, 仅取决于n和k, 查表获取

余项: $R(I_n)=\int_a^bR_n(x)dx \quad 其中, R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\omega_{n+1}(x)\\$ 

- *实际上就是拉格朗日余项求积*



#### 低阶Newton-Cotes公式

##### 梯形公式(n=1)

梯形求积公式(两点公式): $T=I_1(f)=\frac{(b-a)}2[f(a)+f(b)]\\$

梯形公式余项: $R(T)=R(I_1)=\int_a^bR_1(x)dx=-\frac{(b-a)^3}{12}f^{\prime\prime}(\eta)\\$

- 梯形(trapezia)公式具有1次代数精度

##### Simpson公式(n=2)

Simpson求积公式(三点公式, 抛物线公式): $$\begin{aligned}S=I_2(f)&=(b-a)[\frac16f(x_0)+\frac46f(x_1)+\frac16f(x_2)]\\&=\frac{b-a}6[f(a)+4f(\frac{a+b}2)+f(b)]\end{aligned}$$

Simpson公式的余项: $R(S)=R(I_2)=\int_a^bR_2(x)dx =-\frac{b-a}{180}\Big(\frac{b-a}{2}\Big)^4f^{(4)}(\eta)\\$

- Simpson公式具有3次代数精度



#### Newton-Cotes公式 代数精度定理

==定理==：当n为偶数时，Newton-Cotes公式至少具有n+1次代数精度



#### Newton-Cotes公式的稳定性

记精确值为$f(x_k)$,近似值为$\tilde{f}(x_k)$, 误差$\varepsilon_k=f(x_k)-\tilde{f}(x_k)$

则积分精确值和近似值误差为: $I_n-\tilde{I}_n=(b-a)\sum_{k=0}^nC_k^{(n)}[f(x_k)-\tilde{f}(x_k)]\\$
$$
\begin{aligned}&I_n-\bar{I}_n&&=(b-a)\sum_{k=0}^nC_k^{(n)}\varepsilon_k\\
&\left|I_n-\bar{I}_n\right|&&\leq(b-a)\sum_{k=0}^n\left|C_k^{(n)}\right| |\varepsilon_k|\\&&&\leq(b-a)\varepsilon\sum_{k=0}^n\left|C_k^{(n)}\right|\end{aligned}
$$

- $\text{性质}:\sum_{k=0}^nC_k^{(n)}=1$ 
- $\varepsilon=\max\{|\varepsilon_k|\}$

$\text{若 }\forall k\leq n\text{,}C_k^{(n)}>0\text{,有}\left|I_n-\bar{I}_n\right|\leq(b-a)\varepsilon $

**结论**

Newton-Cotes公式的舍入误差只是函数值误差的**(b-a)倍**

即$\forall k\leq n\text{ ,C}_k^{(n)}>0$时, Newton-Cotes公式是稳定的

- 稳定: 指误差是否会在计算过程中显著增长
- 实际上, 当n<8时, 公式都是稳定的

若$C_k^{(n)}$有正有负，有$$(b-a)\varepsilon\sum_{k=0}^n\left|C_k^{(n)}\right|\geq(b-a)\varepsilon\sum_{k=0}^nC_k^{(n)}=(b-a)\varepsilon $$

此时,公式的稳定性将无法保证

- 因此,在实际应用中一般不使用高阶Newton-Cotes公式, 而是采用低阶复合求积法

## 复合求积公式

### **公式与余项**

|       | 求积公式                                                     | 单纯求积公式的余项                               | 复合求积公式的余项                             |
| ----- | ------------------------------------------------------------ | ------------------------------------------------ | ---------------------------------------------- |
| $T_n$ | $\frac h2[f(a)+2\sum_{k=1}^{n-1}f(x_k)+f(b)]\\$              | $-\frac{(b-a)}{12}(b-a)^2f''(\eta)\\$            | $-\frac{(b-a)}{12}(h)^2f''(\eta)\\$            |
| $S_n$ | $\frac h6[f(a)+4\sum_{k=0}^{n-1}f(x_{k+\frac12})+2\sum_{k=1}^{n-1}f(x_k)+f(b)]\\$ | $-\frac{b-a}{180}(\frac{b-a}2)^4f^{(4)}(\eta)\\$ | $-\frac{b-a}{180}(\frac{h}2)^4f^{(4)}(\eta)\\$ |

- 复合求积公式的误差就是将小区间(长度为步长h)的误差逐个累加

### 收敛阶

==定义==: 若一个积分公式的误差满足 $\lim_{h\to0}\frac{R[f]}{h^p}=C<\infty, 且C\neq 0\\$ 则称该公式是$p$ 阶收敛的。

- $T_n\thicksim O\left(h^2\right),S_n\thicksim O\left(h^4\right),C_n\thicksim O\left(h^6\right)$



4.4龙贝格求积公式

